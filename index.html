<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="public/icon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <title>GOG 角色车卡系统</title>
    <style>
        @import url(style.css);
    </style>
    <script src="https://unpkg.com/docx@7.8.2/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>

<body>
    <div id="toast" class="toast-hidden">角色已保存！</div>

    <div class="container" id="main-container">

        <header>
            <h1>GOG 角色档案</h1>
        </header>

        <div class="character-sheet">
            <div class="basic-attribution-container">
                <div class="section">
                    <h2>基本信息</h2>
                    <div class="character-info-grid">
                        <div class="character-portrait-container">
                            <!-- 肖像显示区域 -->
                            <div class="portrait-preview" id="portrait-preview">
                                <img id="character-portrait" src="" alt="角色肖像"
                                    style="width: 100%; height: 100%; object-fit: cover; display: none;">
                                <div id="portrait-placeholder">暂无肖像<br />(w:h=4:5)</div>
                            </div>
                        </div>

                        <div class="character-form-fields">
                            <div class="form-group" style="grid-column: span 2;">
                                <label for="character-name">姓名</label>
                                <div class="auto-height-content" contenteditable="true" id="character-name"
                                    style="font-size: 14px; width: 100%;"></div>
                            </div>

                            <div class="form-group" style="grid-column: span 2;">
                                <label for="player-name">玩家</label>
                                <div class="auto-height-content" contenteditable="true" id="player-name"
                                    style="font-size: 14px; width: 100%;"></div>
                            </div>
                            <div class="form-group">
                                <label for="character-gender">性别</label>
                                <div class="select-container">
                                    <div class="custom-select" tabindex="0">
                                        <select id="character-gender">
                                            <option value="男">男</option>
                                            <option value="女">女</option>
                                            <option value="其他">其他</option>
                                            <option value="未知">未知</option>
                                        </select>
                                        <div class="select-selected">男</div>
                                        <div class="select-items">
                                            <div class="select-item" data-value="男">男</div>
                                            <div class="select-item" data-value="女">女</div>
                                            <div class="select-item" data-value="其他">其他</div>
                                            <div class="select-item" data-value="未知">未知</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="character-age">年龄</label>
                                <input type="number" id="character-age" min="0">
                            </div>

                            <div class="form-group">
                                <label for="character-alignment">阵营</label>
                                <div class="select-container">
                                    <div class="custom-select" tabindex="0">
                                        <select id="character-alignment">
                                            <option value="守序善良">守序善良</option>
                                            <option value="中立善良">中立善良</option>
                                            <option value="混乱善良">混乱善良</option>
                                            <option value="守序中立">守序中立</option>
                                            <option value="绝对中立">绝对中立</option>
                                            <option value="混乱中立">混乱中立</option>
                                            <option value="守序邪恶">守序邪恶</option>
                                            <option value="中立邪恶">中立邪恶</option>
                                            <option value="混乱邪恶">混乱邪恶</option>
                                        </select>
                                        <div class="select-selected">守序善良</div>
                                        <div class="select-items">
                                            <div class="select-item" data-value="守序善良">守序善良</div>
                                            <div class="select-item" data-value="中立善良">中立善良</div>
                                            <div class="select-item" data-value="混乱善良">混乱善良</div>
                                            <div class="select-item" data-value="守序中立">守序中立</div>
                                            <div class="select-item" data-value="绝对中立">绝对中立</div>
                                            <div class="select-item" data-value="混乱中立">混乱中立</div>
                                            <div class="select-item" data-value="守序邪恶">守序邪恶</div>
                                            <div class="select-item" data-value="中立邪恶">中立邪恶</div>
                                            <div class="select-item" data-value="混乱邪恶">混乱邪恶</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="character-nationality">国籍</label>
                                <input type="text" id="character-nationality">
                            </div>

                            <div class="form-group">
                                <label for="character-class">职业</label>
                                <input type="text" id="character-class">
                            </div>

                            <div class="form-group">
                                <label for="character-blessing">赐福</label>
                                <input type="text" id="character-blessing">
                            </div>
                        </div>
                    </div>

                    <div class="form-group full-width" style="display: block;">
                        <label for="character-description">描述：</label>
                        <div class="auto-height-content" contenteditable="true" id="character-description"
                            placeholder="可以描述种族、个人背景故事等" style="font-size: 14px;"></div>
                    </div>
                </div>

                <div class="section">
                    <h2>属性系统</h2>
                    <div class="isGod-container">
                        <div class="form-group" style="display:flex;margin-bottom: 10px;margin-top: 0px;">
                            <label for="isGod"
                                style="min-width: max-content;padding-top: 9px; padding-bottom: 9px;">身份：</label>
                            <button id="isGod" class="btn-isGod"></button> <!--内容动态生成-->
                        </div>
                        <div style="font-size: 12px; color: #dddddd; margin-bottom: 10px;">
                            （人类六大属性基础值范围：0~10，总值范围0~20；神明不设上限）<br>（人类健康/魔力属性基础值范围：0~100；神明不设上限）</div>
                    </div>
                    <div class="attributes-grid">
                        <div class="attribute-item">
                            <label for="attr-STR-base">力量</label>
                            <div class="attribute-controls">
                                <input type="number" id="attr-STR-base" min="0" value="5" title="基础值"
                                    class="base-value">
                                <span>+</span>
                                <input type="number" id="attr-STR-status" step="1" value="0" title="状态调整"
                                    class="status-adj">
                                <span>+</span>
                                <input type="number" id="attr-STR-blessing" step="1" value="0" title="赐福调整"
                                    class="blessing-adj">
                                <span>=</span>
                                <span class="total-value" id="attr-STR-total">5</span>
                            </div>
                        </div>

                        <div class="attribute-item">
                            <label for="attr-DEX-base">敏捷</label>
                            <div class="attribute-controls">
                                <input type="number" id="attr-DEX-base" min="0" value="5" title="基础值"
                                    class="base-value"><span>+</span>
                                <input type="number" id="attr-DEX-status" step="1" value="0" title="状态调整"
                                    class="status-adj"><span>+</span>
                                <input type="number" id="attr-DEX-blessing" step="1" value="0" title="赐福调整"
                                    class="blessing-adj"><span>=</span>
                                <span class="total-value" id="attr-DEX-total">5</span>
                            </div>
                        </div>

                        <div class="attribute-item">
                            <label for="attr-INT-base">智慧</label>
                            <div class="attribute-controls">
                                <input type="number" id="attr-INT-base" min="0" value="5" title="基础值"
                                    class="base-value"><span>+</span>
                                <input type="number" id="attr-INT-status" step="1" value="0" title="状态调整"
                                    class="status-adj"><span>+</span>
                                <input type="number" id="attr-INT-blessing" step="1" value="0" title="赐福调整"
                                    class="blessing-adj"><span>=</span>
                                <span class="total-value" id="attr-INT-total">5</span>
                            </div>
                        </div>

                        <div class="attribute-item">
                            <label for="attr-CHA-base">魅力</label>
                            <div class="attribute-controls">
                                <input type="number" id="attr-CHA-base" min="0" value="5" title="基础值"
                                    class="base-value"><span>+</span>
                                <input type="number" id="attr-CHA-status" step="1" value="0" title="状态调整"
                                    class="status-adj"><span>+</span>
                                <input type="number" id="attr-CHA-blessing" step="1" value="0" title="赐福调整"
                                    class="blessing-adj"><span>=</span>
                                <span class="total-value" id="attr-CHA-total">5</span>
                            </div>
                        </div>

                        <div class="attribute-item">
                            <label for="attr-WIS-base">感知</label>
                            <div class="attribute-controls">
                                <input type="number" id="attr-WIS-base" min="0" value="5" title="基础值"
                                    class="base-value"><span>+</span>
                                <input type="number" id="attr-WIS-status" step="1" value="0" title="状态调整"
                                    class="status-adj"><span>+</span>
                                <input type="number" id="attr-WIS-blessing" step="1" value="0" title="赐福调整"
                                    class="blessing-adj"><span>=</span>
                                <span class="total-value" id="attr-WIS-total">5</span>
                            </div>
                        </div>

                        <div class="attribute-item">
                            <label for="attr-MAG-base">法力</label>
                            <div class="attribute-controls">
                                <input type="number" id="attr-MAG-base" min="0" value="5" title="基础值"
                                    class="base-value"><span>+</span>
                                <input type="number" id="attr-MAG-status" step="1" value="0" title="状态调整"
                                    class="status-adj"><span>+</span>
                                <input type="number" id="attr-MAG-blessing" step="1" value="0" title="赐福调整"
                                    class="blessing-adj"><span>=</span>
                                <span class="total-value" id="attr-MAG-total">5</span>
                            </div>
                        </div>

                        <div class="attribute-item">
                            <label for="attr-HP-current">健康</label>
                            <div class="attribute-controls" style="gap: 0px;">
                                <input type="number" id="attr-HP-base" min="0" value="30" title="基础值" class="base-value">
                                <input type="number" id="attr-HP-current" value="5" title="当前值" class="current-value">
                                <div class="health-bar-container">
                                    <div class="health-bar" id="hp-bar"></div>
                                    <div class="health-base-bar" id="hpb-bar"></div>
                                </div>
                                <span class="max-value" id="attr-HP-max" title="上限=种族基础值+力量×2">15</span>
                            </div>
                        </div>

                        <div class="attribute-item">
                            <label for="attr-MP-current">魔力</label>
                            <div class="attribute-controls" style="gap: 0px;">
                                <input type="number" id="attr-MP-base" min="0" value="5" title="基础值" class="base-value">
                                <input type="number" id="attr-MP-current" value="5" title="当前值" class="current-value">
                                <div class="mana-bar-container">
                                    <div class="mana-bar" id="mp-bar"></div>
                                    <div class="mana-base-bar" id="mpb-bar"></div>
                                </div>
                                <span class="max-value" id="attr-MP-max" title="上限=种族基础值+法力">10</span>
                            </div>
                        </div>
                    </div>

                    <h2>状态系统</h2>
                    <div id="status-tags" style="margin-top: 5px;">
                        <!-- 标签将通过JavaScript动态生成 -->
                    </div>
                    <div class="tag-input">
                        <input type="text" id="new-tag" placeholder="示例：疯狂(1)：魅力-1，法力-1"
                            style="padding: 7px 15px; border-radius: 0; border: none; border-right: 1px solid #eeeeee;">
                        <button id="add-tag" class="btn"
                            style="border-radius: 0px 7px 7px 0px;border: none; height: 100%;">添加</button>
                    </div>
                </div>
            </div>

            <div class="section" style="grid-column: span 2;">
                <div class="blessing-grid">
                    <div style="margin-top: 0; min-width: 0;">
                        <h2>赐福系统</h2>
                        <input class="blessingFullName" type="text" id="blessingFullName"
                            placeholder="权柄编号-神明职能-神明称号-神明真名">
                        <div id="soul-status"
                            style="color: #ffffffe0;min-width: max-content;text-align: center; margin-bottom: 6px;">
                            世俗之人
                        </div>
                        <div class="character-form-fields">
                            <div class="form-group" style="display:flex;">
                                <label for="blessing-soul"
                                    style="min-width: max-content; margin: auto 0;">赐福经验值</label>
                                <!--原先为“灵魂完整度”-->
                                <div style="display: flex;padding-right: 10px;">
                                    <input type="number" id="blessing-soul" style=" padding-top: 8px;" min="0" max="100"
                                        value="100">
                                </div>
                            </div>

                            <div class="form-group" style="display:flex;">
                                <label for="blessing-level"
                                    style="min-width: max-content; margin: auto 0;">赐福等级</label>
                                <div class="select-container">
                                    <div class="custom-select" tabindex="0">
                                        <select id="blessing-level">
                                            <option value="0">0级</option>
                                            <option value="1">1级</option>
                                            <option value="2">2级</option>
                                            <option value="3">3级</option>
                                            <option value="4">4级</option>
                                            <option value="5">5级</option>
                                            <option value="6">6级</option>
                                            <option value="7">7级</option>
                                            <option value="8">8级</option>
                                            <option value="9">9级</option>
                                            <option value="10">10级</option>
                                        </select>
                                        <div class="select-selected">0级</div>
                                        <div class="select-items">
                                            <div class="select-item" data-value="0">0级</div>
                                            <div class="select-item" data-value="1">1级</div>
                                            <div class="select-item" data-value="2">2级</div>
                                            <div class="select-item" data-value="3">3级</div>
                                            <div class="select-item" data-value="4">4级</div>
                                            <div class="select-item" data-value="5">5级</div>
                                            <div class="select-item" data-value="6">6级</div>
                                            <div class="select-item" data-value="7">7级</div>
                                            <div class="select-item" data-value="8">8级</div>
                                            <div class="select-item" data-value="9">9级</div>
                                            <div class="select-item" data-value="10">10级</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="table-auto">
                            <table class="blessing-table">
                                <thead>
                                    <tr>
                                        <th style="width: 10%;">赐福<br>等级</th>
                                        <th style="width: 20%;">关联属性</th>
                                        <th style="width: 30%;">赐福特技</th>
                                        <th style="width: 30%;">异化程度</th>
                                        <th style="width: 10%;">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="blessing-container">
                                    <!-- 动态生成数据 -->
                                </tbody>
                            </table>
                        </div>
                        <div class="form-group" style="margin-top: 15px;">
                            <button id="add-blessingSystem" class="btn">添加</button>
                        </div>
                    </div>

                    <div
                        style="margin-top: 0; padding-top: 0; display: flex; flex-direction: column; min-width: 0; justify-content: center;">
                        <div class="table-auto">
                            <table class="blessing-skills-table">
                                <thead>
                                    <tr>
                                        <th style="width: 10%;">名称</th>
                                        <th style="width: 80%;">描述</th>
                                        <th style="width: 10%;">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="blessing-skills-container">
                                    <!-- 动态生成数据 -->
                                </tbody>
                            </table>
                        </div>
                        <div class="form-group" style="margin-top: 15px;">
                            <button id="add-blessingSkills" class="btn">添加</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" style="grid-column: span 2;">
                <h2>技能系统</h2>
                <label>技能熟练度总点数: <span id="skill-prof-left" style="color: #28a745;">0</span></label>
                <div class="table-auto">
                    <table class="skills-list">
                        <thead>
                            <tr>
                                <th style="width: 20%;">技能名</th>
                                <th style="width: 10%;" title="技能熟练度在1~5之间；1：略懂；2：学徒；3：专家；4：精通；5：大师。">熟练度</th>
                                <th style="width: 10%;">使用次数</th>
                                <th style="width: 50%;">描述</th>
                                <th style="width: 10%;">操作</th>
                            </tr>
                        </thead>
                        <tbody id="skills-container">
                            <!-- 技能列表将通过JavaScript动态生成 -->
                        </tbody>
                    </table>
                </div>

                <div class="form-group"
                    style="margin-top: 15px;max-width: 250px;display: grid;grid-template-columns: 2fr 1fr;">
                    <div class="select-container">
                        <div class="custom-select" tabindex="0">
                            <select id="skill-category-select"
                                style="color: #666666;border-left: 1px solid #eeeeee;border-top: 1px solid #eeeeee;border-bottom: 1px solid #eeeeee;border-radius: 8px 0px 0px 8px;">
                                <option value="STR">力量类技能</option>
                                <option value="DEX">敏捷类技能</option>
                                <option value="INT">智慧类技能</option>
                                <option value="CHA">魅力类技能</option>
                                <option value="WIS">感知类技能</option>
                                <option value="MAG">法力类技能</option>
                                <option value="PRF">职业类技能</option>
                            </select>
                            <div class="select-selected"
                                style="color: #666666;border: 1px solid #eeeeee; border-right: none; border-radius: 8px 0px 0px 8px;padding-left: 12px;">
                                力量类技能</div>
                            <div class="select-items">
                                <div class="select-item" data-value="STR">力量类技能</div>
                                <div class="select-item" data-value="DEX">敏捷类技能</div>
                                <div class="select-item" data-value="INT">智慧类技能</div>
                                <div class="select-item" data-value="CHA">魅力类技能</div>
                                <div class="select-item" data-value="WIS">感知类技能</div>
                                <div class="select-item" data-value="MAG">法力类技能</div>
                                <div class="select-item" data-value="PRF">职业类技能</div>
                            </div>
                        </div>
                    </div>
                    <button id="add-skill" class="btn" style="border-radius: 0px 8px 8px 0px;"
                        title="支持自创技能喵~">添加技能</button>
                </div>
            </div>

            <div class="section" style="grid-column: span 2;">
                <h2>装备系统</h2>
                <div class="table-auto">
                    <table class="items-list">
                        <thead>
                            <tr>
                                <th style="width: 20%;">名称</th>
                                <th style="width: 15%;">类别</th>
                                <th style="width: 25%;">属性影响</th>
                                <th style="width: 30%;">描述</th>
                                <th style="width: 10%;">操作</th>
                            </tr>
                        </thead>
                        <tbody id="equipment-container">
                            <!-- 装备列表将通过JavaScript动态生成 -->
                        </tbody>
                    </table>
                </div>
                <div class="form-group" style="margin-top: 15px;">
                    <button id="add-equipment" class="btn" title="支持自创装备喵~">添加装备</button>
                </div>
            </div>

            <div class="section" style="grid-column: span 2;">
                <h2>背包系统</h2>
                <label>总负重: <span style="color: #28a745;"><span id="total-weight">0.0</span> kg</span></label>
                <div class="table-auto">
                    <table class="items-list">
                        <thead>
                            <tr>
                                <th style="width: 20%;">名称</th>
                                <th style="width: 15%;">重量</th>
                                <th style="width: 45%;">描述</th>
                                <th style="width: 10%;">数量</th>
                                <th style="width: 10%;">操作</th>
                            </tr>
                        </thead>
                        <tbody id="inventory-container">
                            <!-- 物品列表将通过JavaScript动态生成 -->
                        </tbody>
                    </table>
                </div>

                <div class="form-group"
                    style="margin-top: 15px;max-width: 250px;display: grid;grid-template-columns: 2fr 1fr;">
                    <div class="select-container">
                        <div class="custom-select" tabindex="0">
                            <select id="item-category-select"
                                style="color: #666666;border-left: 1px solid #eeeeee;border-top: 1px solid #eeeeee;border-bottom: 1px solid #eeeeee;border-radius: 8px 0px 0px 8px;">
                                <option value="equipment">装备</option>
                                <option value="food">食物</option>
                                <option value="currency">钱币</option>
                                <option value="medical">医疗物品</option>
                                <option value="potions">药剂</option>
                                <option value="supplies">储备/其他物品</option>
                            </select>
                            <div class="select-selected"
                                style="color: #666666;border: 1px solid #eeeeee; border-right: none; border-radius: 8px 0px 0px 8px;padding-left: 12px;">
                                装备</div>
                            <div class="select-items">
                                <div class="select-item" data-value="equipment">装备</div>
                                <div class="select-item" data-value="food">食物</div>
                                <div class="select-item" data-value="currency">钱币</div>
                                <div class="select-item" data-value="medical">医疗物品</div>
                                <div class="select-item" data-value="potions">药剂</div>
                                <div class="select-item" data-value="supplies">储备/其他物品</div>
                            </div>
                        </div>
                    </div>
                    <button id="add-item" class="btn" style="border-radius: 0px 8px 8px 0px;"
                        title="支持自创物品喵~">添加物品</button>
                </div>
            </div>
            <div class="section" style="grid-column: span 2;">
                <h2>日志系统</h2>
                <p style="font-size: 14px; color: #dddddd">（你的形象描述、思想与信念、重要之人、珍视之物、意义非凡之地、特质、伤口与疤痕……）</p>
                <div id="log-sections">
                    <!-- 标签将通过JavaScript动态生成 -->
                </div>
                <div class="form-group" style="margin-top: 15px;">
                    <button id="add-log" class="btn">添加日志</button>
                </div>
            </div>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-container">
            <!-- 新建按钮 -->
            <button id="new-character" class="nav-btn" title="新建角色">
                <span class="nav-text">新建</span>
            </button>

            <!-- 保存按钮 -->
            <button id="save-character" class="nav-btn" title="保存角色">
                <span class="nav-text">保存</span>
            </button>

            <button id="show-dice" class="nav-btn" title="显示骰子面板">
                <span class="nav-text" id="show-dice-icon"
                    style="background-image: linear-gradient(0deg, #333333, #333333); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;"><i
                        class="fa-solid fa-dice-d6"></i></span>
            </button>

            <!-- 图鉴按钮 -->
            <button id="show-roster" class="nav-btn" title="显示角色列表">
                <span class="nav-text">图鉴</span>
            </button>

            <!-- 数据管理按钮 (带下拉面板) -->
            <div class="nav-dropdown">
                <button id="show-data" class="nav-btn" title="数据管理">
                    <span class="nav-text">数据</span>
                </button>
                <div id="data-panel" class="data-panel">
                    <div class="panel-header">
                        <h4>数据管理</h4>
                    </div>
                    <div class="data-button-container">
                        <small
                            style="color: #666666; font-size: 12px; line-height: 1;">注：1、所有角色数据存储在本地浏览器的indexdb中，数据库文件名为GOGCharacterDB</br>
                            2、使用无痕模式可能导致indexdb数据丢失</br>
                            3、如果QQ上打开导出的WORD中表格显示有问题，请先在office中任意修改再点击保存，或能解决问题</br>
                            4、<strong>导出前请务必先保存</strong>
                        </small>
                        </br>
                        </br>
                        <label id="import-character" class="data-btn" style="border-radius: 8px 8px 0px 0px;">
                            导入角色
                            <input type="file" accept=".json" style="display: none;">
                        </label>
                        <label id="import-full-data" class="data-btn" style="border-radius: 0px;">
                            导入图鉴
                            <input type="file" accept=".js" style="display: none;">
                        </label>
                        <button id="export-character" class="data-btn" style="border-radius: 0px;">
                            导出当前角色
                        </button>
                        <button id="export-word" class="data-btn" style="border-radius: 0px;">
                            导出当前为Word
                        </button>
                        <button id="export-all" class="data-btn" style="border-radius: 0px;">
                            导出全部角色
                        </button>
                        <button id="delete-db-btn" class="data-btn-danger" title="此操作将永久删除所有角色以及图鉴数据，不可恢复！"
                            style="border-radius: 0px 0px 8px 8px;">
                            删除数据库
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 骰子面板 -->
    <div id="dice-panel" class="dice-panel">
        <div id="dice-panel-list" class="dice-panel-list active">
            <div class="panel-header">
                <div style="display: flex;max-width: 550px;margin: 0px auto;justify-content: space-around;">
                    <button id="delete-all-dices" class="dice-panel-header-btn">清空</button>
                    <h4 style="margin: 5px auto;">投掷鉴定</h4>
                    <button id="new-dice-preset" class="dice-panel-header-btn">新建</button>
                </div>
            </div>

            <div id="dices-list" class="dices-list active"></div>
        </div>

        <!-- 投掷配置 -->
        <div id="dice-config" class="dice-config">
            <div style="display: flex;justify-content: space-between; width: 100%;">
                <button id="back-to-list" class="toggle-icon"><i class="fa-solid fa-angle-left"></i></button>
                <div style="display: flex;">
                    <button id="show-expression-help" class="toggle-icon">语法指引</button>
                    <button id="save-preset" class="toggle-icon">保存</button>
                </div>
            </div>
            <input type="text" id="preset-name" placeholder="给这个组合起个名字"
                style="margin:0 auto;text-align: center; font-weight: bold; padding: 0 15px;">
            <div class="config-form">
                <div id="expression-help" class="expression-help">支持格式: 2d6, 3d6kh2, 4d6kl3, (1d4+5)等，不支持乘除和中文括号<br>
                    <strong>kh</strong>=保留高值, <strong>kl</strong>=保留低值<br>
                    建议输入顺序：命运骰（2d6）+属性+技能+装备+奖励/惩罚<br>
                    示例：2d6+4+5-3+(2d6kh1+1)&nbsp;&nbsp;&nbsp;<strong>按[Enter]键投掷</strong>
                </div>
                <div style="display: flex; padding: 10px 0px; margin: 0 10px;">
                    <input type="text" id="dice-expression" class="dice-expression" placeholder="请输入骰子表达式，如：2d6+3">
                    <button id="roll-dice" class="roll-dice">投掷</button>
                </div>
            </div>
        </div>
    </div>
    <!-- 头像上传控件 -->
    <div class="portrait-controls" id="portrait-controls">
        <button class="close-result-modal" id="close-portrait-controls">×</button>
        <label for="upload-portrait" class="btn">上传肖像</label>
        <input type="file" id="upload-portrait" accept="image/*" style="display: none;">
        <button id="remove-portrait" class="btn btn-danger">移除肖像</button>
    </div>
    <!-- 投掷结果显示模态框 -->
    <div id="dice-result-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h4>投掷结果</h4>
                <button class="close-result-modal" id="close-result-modal">×</button>
            </div>
            <div class="modal-body">
                <div id="dice-calculation"></div>
                <div id="dice-result" class="result-final"></div>
            </div>
        </div>
    </div>
    <!-- 图鉴面板 -->
    <div id="roster-panel" class="roster-panel">
        <div class="panel-header">
            <div class="roster-tabs">
                <button class="tab-btn active" data-tab="characters">角色</button>
                <button class="tab-btn" data-tab="blessings">赐福</button>
                <button class="tab-btn" data-tab="skills">技能</button>
                <button class="tab-btn" data-tab="equipments">装备</button>
                <button class="tab-btn" data-tab="inventory">背包</button>
                <button class="tab-btn" data-tab="classes">职业</button>
            </div>
        </div>

        <div id="characters-list" class="roster-list tab-content active"></div>

        <div id="blessings-list" class="roster-list tab-content"></div>

        <div id="skills-list" class="roster-list tab-content"></div>

        <div id="equipments-list" class="roster-list tab-content"></div>

        <div id="inventory-list" class="roster-list tab-content"></div>

        <div id="classes-list" class="roster-list tab-content"></div>
    </div>

    <script src="scripts/db.js"></script>
    <script src="scripts/models.js"></script>
    <script src="scripts/import-export.js"></script>
    <script src="scripts/app.js"></script>
    <script src="scripts/data.js"></script>
</body>

</html>